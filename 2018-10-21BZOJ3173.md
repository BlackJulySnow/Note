---
title: 2018-10-21BZOJ3173
tags: 新建,模板,小书匠
grammar_cjkRuby: true
---


倒序构造法：对于构造最终序列，可以使用倒序的方法来反向模拟数的插入过程。可以理解我们现将所有数放进来，然后一个个拔出去。我们用一个数组表示：如果这个数还没有被拔出去，那么数组这一位为1，否则为0。如图：假设现在应该拔出a[i](即输入的：数字i插入到i位置上)

![Image](./images/1540089943027.png)

那么它在哪里？我们就在这个数组中查找第一个前缀和等于i的位置，那里就是它的真实位置（注意这里的i可以理解为第i个插入的），所以这一步我们使用二分法加一个维护前缀的东西就可以完成（偷懒就用个STL bound挺好的）。我们又一次的到了最终序列，然后就随意DP+优化就完成了。